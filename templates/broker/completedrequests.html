{% extends 'base.html' %}
{% block content %}
  <div class="jumbotron">
    <h1>hey  {{ user.username}}</h1>
    <br>
    <br>
    {% if csize %}
      <ul class="list-group">
        <li class="list-group-item active"><h3>Completed Requests ({{ csize }})</h3></li>
        {% for item in completedrequests_with_disputes %}
        <li class="list-group-item">
          <h5 style="float: left;">From: {{ item.connection.customer.user.username }}</h5>
          <br style="clear:both;">
          <p class="mb-1"><small>Requested: {{ item.connection.created_time|date:"F d, Y H:i" }} | Completed: {{ item.connection.modified_time|date:"F d, Y H:i" }}</small></p>
          <p class="mb-1"><strong>About:</strong> {{ item.connection.description }}</p>
          {% if item.latest_dispute %}
            <div class="mt-2 p-2 border border-info rounded bg-light">
              <p class="text-info mb-1"><strong>Dispute Logged (Status: {{ item.latest_dispute.status }})</strong></p>
              <p class="small mb-0"><strong>Reason:</strong> {{ item.latest_dispute.reason|truncatewords:30 }}</p>
              <p class="small text-muted mb-0">Reported by: {{ item.latest_dispute.reporter_user.username }} on {{ item.latest_dispute.created_at|date:"F d, Y H:i" }}</p>
            </div>
          {% endif %}
        </li>
        {% endfor %}
      </ul>
    {% else %}
      <p>No completed requests.</p>
    {% endif %}
  </div>
{% endblock content %}